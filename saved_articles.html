<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Saved Articles | News Digest</title>
  <link rel="stylesheet" href="apple.css">
</head>
<body>
  <div class="title-box">
    <div class="title-side date" id="date"></div>
    <h1 class="main-title">Saved Articles</h1>
    <div class="title-side weather" id="weather"></div>
  </div>

  <nav class="nav-bar">
    <a href="homepage.html">Home</a>
    <a href="personalized.html">Personal Feed</a>
    <a href="compare.html">Compare Coverage</a>
    <a href="stocks.html">Stocks</a>
    <a href="about.html">About</a>
  </nav>

  <section class="article-list" id="savedArticles">
    <p>Loading saved articles...</p>
  </section>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const dateEl = document.getElementById('date');
      const weatherEl = document.getElementById('weather');

      // Load current date
      const today = new Date();
      const dateOptions = { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' };
      dateEl.textContent = today.toLocaleDateString(undefined, dateOptions);

      // Load weather
      fetch("https://api.open-meteo.com/v1/forecast?latitude=38.9&longitude=-77.03&current_weather=true")
        .then(res => res.json())
        .then(data => {
          const tempF = Math.round((data.current_weather.temperature * 9/5) + 32);
          weatherEl.textContent = `Washington, DC: ${tempF}Â°F`;
        });

      // Fetch saved articles
      const container = document.getElementById("savedArticles");
      fetch("/api/saved")
        .then(res => res.json())
        .then(articles => {
          container.innerHTML = "";
          if (articles.length === 0) {
            container.innerHTML = "<p>No saved articles found.</p>";
            return;
          }

          articles.forEach(article => {
            const div = document.createElement("div");
            div.className = "article";
            div.innerHTML = `
              <h3><a href="${article.url}" target="_blank">${article.title}</a></h3>
              <p>${article.source || "Unknown Source"}</p>
            `;
            container.appendChild(div);
            container.appendChild(document.createElement('hr'));
          });
        })
        .catch(() => {
          container.innerHTML = "<p>Error loading saved articles.</p>";
        });
    });
  </script>
</body>
</html>
